		Référentiel Bouygues Telecom CMSINT
		===================================

Bienvenue sur le référentiel de gestion de configuration de l'application CMSINT.

Cette interface fournit une vue sur le référentiel contenant l'ensemble de
l'application EzPublish/CMSINT. Grâce à cet outil, il est possible de
consulter les répertoires CMSINT de tous les serveurs ainsi que l'historique
de toutes les modifications.


Fonctionnalités fournies :
========================

* Accès en lecture seule au répertoire applicatif "/app/ezpublish"
* Accès aux serveurs de Production et Préproduction
* Possibilité de consulter l'historique des modifications
* Chaque modification commitée dans le référentiel contient la date et l'auteur de la modification
* Consultation de l'état d'un dossier ou fichier à une révision (et date) arbitraire dans le passé
* Possibilité de comparer 2 versions d'un fichier
* Génération automatique d'archives des répertoires au format "tar.gz"


Architecture :
============

Le référentiel utilise le produit FSVS, "Fast System VerSioning", lui-même
basé sur Subversion, qui est la référence actuelle en matière d'outil de
gestion de révisions.

Au moins une fois par jour, et plus fréquement si l'équipe hosting Easynet le
juge nécessaire, les modifications apportées aux répertoires clés des serveurs
CMSINT sont poussés sur le référentiel FSVS/Subversion.

FSVS garde une trace de tout type de modifications apportées :
- Modification des fichiers (qu'ils soient binaires ou texte)
- Création, suppression de fichiers / dossiers
- Modification de date, propriétaire, groupe et droits des fichiers et dossiers

Chaque groupe de modification est une "révision". Chaque révision a un numéro
unique, strictement croissant.


Les révisions :
=============

Le numéro de révision est commun à tout le référentiel SVN, transversalement
à tous les projets hébergés.

Dans les pages ViewVC, le numéro affiché derrière chaque élément correspond
à sa dernière modification. Etant donné que la numéroration est commune à
tout le référentiel, il peut y avoir des trous dans la numérotation, celle-ci
est *discontinue*.

PAR EXEMPLE : En consultant la révision numéro 212 de
/cmsint/prod/back/trunk/ezpublish, nous voyons que certains fichiers ont
bien la révision 212, mais d'autres la révision 204. Par contre aucun fichier
ne porte une révision comprise en 205 et 211.

http://10.10.2.44/viewvc/cmsint/prod/back/trunk/ezpublish/?pathrev=212

Ceci signifie que :
1) Seuls quelques fichiers ont changé entre les 204 et 212 de ce répertoire
2) Les révisions 205 à 211 concernent sans doute d'autres branches du
   référentiel.


Utilisation de l'interface Web :
==============================

L'interface web fournit une vue arborescente, que l'on peut parcourir en
cliquant sur les noms des dossiers. Le numéro qui est derrière chaque
fichier/dossier est le numéro de la dernière révision apportée à cet élémént
ou à un élément d'un sous-dossier.

* En cliquant sur un nom de fichier il est possible de consulter :
- les détails de modification de ce fichier
- le contenu du fichier
- les différences entre 2 révisions d'un même fichier

* En cliquant sur un numéro de révision, on accède à l'historique des
  modification de l'élément sélectionné (ou de ses sous-éléments dans le
  cas d'un répertoire).

* En cliquant sur le lien "Download GNU tarball", l'application propose
  automatiquement de télécharger une archive tar du contenu de toute
  l'arborescence affichée.

Ceci peut par exemple servir à récupérer une copie du répertoire "extension"
ou "settings" des serveurs, que ce soit en Prod ou Préprod, sur le FO ou BO.

Affichage des révisions :
=======================

La façon la plus simple d'afficher la liste des révision d'un fichier est
de cliquer sur son nom. Sur cet écran s'affiche pour chaque révision une description
et plusieurs actions possibles. Prenons par exemple la page :
	http://10.10.2.44/viewvc/cmsint/LISEZMOI?view=log
et regardons la révision "238".

* Sous la révision apparaît un message de description.
* En cliquant sur le numéro de révision, on affiche la liste de tous les fichiers
  composant la révision en question (ici il n'y en a qu'un).
* view : Affiche le contenu du fichier pour cette version là.
* download : Permet de télécharger le fichier original, pour cette version.
* annotate : Affiche en face de chaque ligne le numéro de révision et le nom
  de l'auteur du changement.
* Diff to previous 237 : Voir ci-dessous.
* Select for diff : Voir ci-dessous.

Affichage des différences entre 2 versions d'un fichier :
=======================================================

Cette fonction permet de voir précisement ce qui a changé dans un fichier
entre 2 révisions données, et donc entre 2 dates données.

Pour afficher les différences entre 2 versions d'un fichier, il faut d'abord
aller sur la page de log/révisions d'un fichier et utiliser les fonctions suivantes :

* Diff to previous 237 : Affiche la différence entre la version 237 et 238
  du fichier.
* Select for diff : Cette fonction permet de choisir les 2 révisions que
  l'on veut comparer.

Exemple :
Après avoir cliqué sur le lien "Select for diff" qui est derrière la
révision 188, un nouveau lien apparaît sous la révision 238 (et les
suivantes) : "to selected 188".
Ce lien permet de comparer la version 238 à la 188 (au lieu de 237
par défaut).

On peut aussi afficher les différences entre 2 version arbitraires, et
choisir le format d'affichage, en utilisant le formulaire en bas de page.


Navigation dans le temps :
========================

Par défaut, on navigue dans la dernière version de l'arborescence. En rentrant
un numéro de révision dans le champ "Sticky Revision", il devient possible de
remonter dans le temps et de parcourir la même arboscence pour une révision du
passé.

Le champ "Directory revision" affiche la révision dans laquelle vous naviguez.

NOTE 1 : Pensez à revenir à la version courante en cliquant sur "Clear",
         sinon l'inferface restera dans une vue du passé du système !

NOTE 2 : Les fichiers et répertoires qui ont été créés *après* la révision
         sélectionnée n'apparaissent plus à l'écran.


Directory revision :
==================

En cliquant sur le numéro de révision affiché, vous avez accès à l'ensemble
des fichiers d'une révision et aux types de modification qui y ont été
apportés.

La dernière colonne indique le changement apporté par cette révision au
fichier / répertoire correspondant :

* added : L'élément a été ajouté.
* deleted : L'élément a été supprimé.
* modified : Le fichier a été modifié.
* text changed : Le contenu du fichier a changé. En cliquant sur le lien
  "text changed", on affiche une vue "diff" des changements apportés.
* props changed : Les propriétés (date, propriétaire, droits, etc.) on
  changé


Organisation de l'arborescence :
==============================

Premier niveau : 
--------------

/cmsint : Il s'agit du référentiel CMSINT, c'est à dire du répertoire
"/app/ezpublish" des serveurs.

Deuxième niveau :
---------------

/cmsint/prod : Les serveurs de production
/cmsint/preprod : Les serveurs de préproduction

NOTE : à partir de là, les arborescences "prod" et "preprod" sont similaires.

Troisième niveau :
----------------

/cmsint/[pre]prod/back : Les serveurs BO
/cmsint/[pre]prod/front : Les serveurs FO

Quatrième niveau
----------------

Le répertoire "trunk" est une spécificité Subversion, il signifie "la branche
courante" du référentiel.  C'est un répertoire arbitraire qui n'existe que
pour fournir la possibilité d'avoir plusieurs "branches" dans le référentiel.
La gestion multi-branches n'étant pas encore implémentée dans FSVS, cette
fonctionnalité n'est pas encore utilisée.

Cinquième niveau :
----------------

/cmsint/[pre]prod/back/trunk/ezpublish
/cmsint/[pre]prod/front/trunk/ezpublish

Chacun de ces répertoires contient l'arborescence complète de "/app/ezpublish",
en dehors des répertoires "extension" et "settings" qui sont sans doute partagés
via NFS. Dans ce cas, il y a une arborescence spéciale, qui ne contient que
ces 2 répertoires :

/cmsint/[pre]prod/front/trunk/ezpublish-extension-settings

Liste des arborescences spéciales plate-forme par plate-forme :
=============================================================

Comme expliqué ci-dessus, les répertoires "extension" et "settings" sont partagés
en NFS entre plusieurs serveurs. Par contre, ils ne sont présents que UNE SEULE
FOIS dans FSVS.

Voici la liste de tous les emplacements, avec entre parenthèses le nom du serveur
sur lequel ce référentiel est monté :

 - Plate-forme de Préproduction
   - Frontaux
      * Il n'y a pas de répertoire "ezpublish-extension-settings" pour les frontaux
        car il est partagé en NFS avec le Backoffice.
   - Backoffice
      * /cmsint/preprod/back/trunk/ezpublish-extension-settings (backezp-pp1)
 - Plate-forme de Production
   - Frontaux
      * /cmsint/prod/front/trunk/ezpublish-extension-settings (frontezp-p1)
   - Backoffice
      * /cmsint/prod/back/trunk/ezpublish-extension-settings (backezp-p1)

Exclusions :
==========

Les fichiers et dossiers suivants sont normalements EXCLUS de la gestion FSVS :
- Les fichiers temporaires
- Les dossiers de cache
- Les fichiers de logs


Références :
==========

Site d'information Subversion : http://subversion.tigris.org/
Site d'information FSVS : http://fsvs.tigris.org/
Site d'information ViewVC : http://viewvc.tigris.org/

